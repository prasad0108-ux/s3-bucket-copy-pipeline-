trigger: none   # ðŸ”´ REQUIRED for runtime popup

parameters:
- name: sourceBucket
  displayName: "Source S3 Bucket"
  type: string

- name: destinationBucket
  displayName: "Destination S3 Bucket"
  type: string

- name: dryRun
  displayName: "Dry Run (true = no copy)"
  type: boolean
  default: false

pool:
  vmImage: ubuntu-latest

steps:
- checkout: self

- task: AWSShellScript@1
  displayName: "S3 Bucket-to-Bucket Copy"
  inputs:
    awsCredentials: aws-s3-copy-connection
    regionName: af-south-1
    scriptType: inline
    inlineScript: |
      chmod +x scripts/s3_copy.sh
      ./scripts/s3_copy.sh \
        "${{ parameters.sourceBucket }}" \
        "${{ parameters.destinationBucket }}" \
        "${{ parameters.dryRun }}"
